# 📋 JSON 规整工具使用说明

## 📁 文件说明

### 1. 核心文件
- **`adjust.py`** - JSON 规整脚本，根据"原文"自动提取结构化信息填充"规整后"字段
- **`规整规则说明.md`** - 详细的规整规则文档
- **`detect_merged_cells_with_accuracy_position.py`** - Excel 转 JSON 工具（岗位需求表格式）

### 2. 数据文件
- **`条件要求较简单的部分岗位岗位要求-模拟数据.xlsx`** - 原始 Excel 数据
- **`条件要求较简单的部分岗位岗位要求-模拟数据.json`** - Excel 转换后的 JSON（规整后字段为空）
- **`条件要求较简单的部分岗位岗位要求-模拟数据_调整后.json`** - 经过规整处理的 JSON（规整后字段已填充）
- **`简单岗位.json`** - 目标格式参考文件

## 🚀 使用方法

### 步骤 1：Excel 转 JSON
```bash
python3 detect_merged_cells_with_accuracy_position.py
```
**输入**: `条件要求较简单的部分岗位岗位要求-模拟数据.xlsx`  
**输出**: `条件要求较简单的部分岗位岗位要求-模拟数据.json`

### 步骤 2：规整处理
```bash
python3 adjust.py
```
**输入**: `条件要求较简单的部分岗位岗位要求-模拟数据.json`  
**输出**: `条件要求较简单的部分岗位岗位要求-模拟数据_调整后.json`

## 📊 规整规则概览

### 资格条件 (资格条件)

| 字段 | 规整规则 | 示例 |
|------|---------|------|
| **学历要求** | • 条件识别: "任一"/"或" → "或"<br>• 排名: 包含"排行榜"的句子<br>• 学历: 包含"985"/"211"或其他学历描述 | `{"条件": "或", "排名": [...], "学历": [...]}` |
| **专业要求** | • 条件识别: "或" → "或"<br>• 专业: 按逗号分割的专业类别<br>• 经历: 包含"具备"/"工作经历"的句子 | `{"条件": "或", "专业": [...], "经历": [...]}` |
| **年龄要求** | • "不超过XX周岁" → "≤XX"<br>• "XX周岁及以上" → "≥XX" | `"≤40"` |
| **绩效要求** | • 条件识别: 同时有"系统内"和"系统外" → "与"<br>• 按关键词分割内容 | `{"条件": "与", "系统内": "...", "系统外": "..."}` |
| **职称要求** | • 识别职称等级关键词<br>• "中级及以上" → `["正高级", "副高级", "中级"]` | `["正高级", "副高级", "中级"]` |
| **工作经历** | • 条件识别: "（1）"和"（2）" → "或"<br>• 按标号分割系统内外 | `{"条件": "或", "南方电网公司系统内应聘人员": "...", "南方电网公司系统外应聘人员": "..."}` |

### 岗位任职条件 (岗位任职条件)

| 字段 | 规整规则 | 示例 |
|------|---------|------|
| **工作经验** | • "X年及以上" → "≥X"<br>• "X-Y年" → "X-Y" | `"≥3"` |
| **能力要求** | • 保持原文数组格式<br>• 不需要规整 | `["（1）...", "（2）..."]` |
| **持证要求** | • 直接复制原文 | `"具备一级建造师职业资格..."` |

## 🔑 关键规则说明

### 1. 条件类型识别
- **"或"条件**: 原文包含 "任一"、"或"、"可选"
- **"且"条件**: 原文包含 "且"、"同时"、"并"

### 2. 比较符号映射
- **≥**: "及以上"、"不少于"
- **>**: "以上"、"超过"
- **≤**: "不超过"
- **<**: "以下"

### 3. 职称等级映射
- **正高级**: "正高级"、"研究员级"
- **副高级**: "副高级"、"高级"
- **中级**: "中级"
- **初级**: "初级"、"助理级"

## ✅ 处理结果

### 统计信息
- **记录数**: 30 条岗位信息
- **成功率**: 100%
- **所有字段**: 均已按规则进行规整处理

### 验证对比
所有规整后的字段格式与目标格式 `简单岗位.json` 保持一致，包括：
- ✅ 数据结构完全匹配
- ✅ 条件类型正确识别
- ✅ 内容分类准确
- ✅ 比较符号转换正确

## 📝 注意事项

1. **不改变原始结构**: 
   - ✅ `adjust.py` **只填充"规整后"字段**，不改变 JSON 结构
   - ✅ 如果"原文"为空，"规整后"也保持为空
   - ✅ 对于不同格式的记录（如简单字符串数组），保持原样不处理

2. **输入文件要求**: 
   - Excel 文件必须是岗位需求表格式
   - 包含"资格条件"和"岗位任职条件"字段

3. **规整规则的局限性**:
   - 基于关键词匹配和正则表达式
   - 对于复杂语义可能需要人工校验
   - 建议处理后抽查部分记录

4. **扩展性**:
   - 可通过修改 `adjust.py` 中的处理函数来调整规则
   - 详细规则说明见 `规整规则说明.md`

## 🔧 自定义规则

如需修改规整规则，请编辑 `adjust.py` 中对应的处理函数：

```python
# 学历要求处理
def process_education_requirement(original_text):
    # 自定义处理逻辑
    pass

# 专业要求处理
def process_major_requirement(original_text):
    # 自定义处理逻辑
    pass

# ... 其他处理函数
```

详细的函数说明和修改指南请参考代码注释。

## 📞 技术支持

如有问题或需要调整规则，请参考：
1. `规整规则说明.md` - 完整的规则文档
2. `adjust.py` - 源代码及注释
3. `简单岗位.json` - 目标格式示例

